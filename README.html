<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style>body {
  max-width: 980px;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 45px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headerlink {
  font: normal 400 16px fontawesome-mini;
  vertical-align: middle;
  margin-left: -16px;
  float: left;
  display: inline-block;
  text-decoration: none;
  opacity: 0;
  color: #333;
}

.markdown-body .headerlink:focus {
  outline: none;
}

.markdown-body h1 .headerlink {
  margin-top: 0.8rem;
}

.markdown-body h2 .headerlink,
.markdown-body h3 .headerlink {
  margin-top: 0.6rem;
}

.markdown-body h4 .headerlink {
  margin-top: 0.2rem;
}

.markdown-body h5 .headerlink,
.markdown-body h6 .headerlink {
  margin-top: 0;
}

.markdown-body .headerlink:hover,
.markdown-body h1:hover .headerlink,
.markdown-body h2:hover .headerlink,
.markdown-body h3:hover .headerlink,
.markdown-body h4:hover .headerlink,
.markdown-body h5:hover .headerlink,
.markdown-body h6:hover .headerlink {
  opacity: 1;
  text-decoration: none;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* MultiMarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px fontawesome-mini;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\e157';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><style>/*GitHub*/
.codehilite {background-color:#fff;color:#333333;}
.codehilite .hll {background-color:#ffffcc;}
.codehilite .c{color:#999988;font-style:italic}
.codehilite .err{color:#a61717;background-color:#e3d2d2}
.codehilite .k{font-weight:bold}
.codehilite .o{font-weight:bold}
.codehilite .cm{color:#999988;font-style:italic}
.codehilite .cp{color:#999999;font-weight:bold}
.codehilite .c1{color:#999988;font-style:italic}
.codehilite .cs{color:#999999;font-weight:bold;font-style:italic}
.codehilite .gd{color:#000000;background-color:#ffdddd}
.codehilite .ge{font-style:italic}
.codehilite .gr{color:#aa0000}
.codehilite .gh{color:#999999}
.codehilite .gi{color:#000000;background-color:#ddffdd}
.codehilite .go{color:#888888}
.codehilite .gp{color:#555555}
.codehilite .gs{font-weight:bold}
.codehilite .gu{color:#800080;font-weight:bold}
.codehilite .gt{color:#aa0000}
.codehilite .kc{font-weight:bold}
.codehilite .kd{font-weight:bold}
.codehilite .kn{font-weight:bold}
.codehilite .kp{font-weight:bold}
.codehilite .kr{font-weight:bold}
.codehilite .kt{color:#445588;font-weight:bold}
.codehilite .m{color:#009999}
.codehilite .s{color:#dd1144}
.codehilite .n{color:#333333}
.codehilite .na{color:teal}
.codehilite .nb{color:#0086b3}
.codehilite .nc{color:#445588;font-weight:bold}
.codehilite .no{color:teal}
.codehilite .ni{color:purple}
.codehilite .ne{color:#990000;font-weight:bold}
.codehilite .nf{color:#990000;font-weight:bold}
.codehilite .nn{color:#555555}
.codehilite .nt{color:navy}
.codehilite .nv{color:teal}
.codehilite .ow{font-weight:bold}
.codehilite .w{color:#bbbbbb}
.codehilite .mf{color:#009999}
.codehilite .mh{color:#009999}
.codehilite .mi{color:#009999}
.codehilite .mo{color:#009999}
.codehilite .sb{color:#dd1144}
.codehilite .sc{color:#dd1144}
.codehilite .sd{color:#dd1144}
.codehilite .s2{color:#dd1144}
.codehilite .se{color:#dd1144}
.codehilite .sh{color:#dd1144}
.codehilite .si{color:#dd1144}
.codehilite .sx{color:#dd1144}
.codehilite .sr{color:#009926}
.codehilite .s1{color:#dd1144}
.codehilite .ss{color:#990073}
.codehilite .bp{color:#999999}
.codehilite .vc{color:teal}
.codehilite .vg{color:teal}
.codehilite .vi{color:teal}
.codehilite .il{color:#009999}
.codehilite .gc{color:#999;background-color:#EAF2F5}
</style><title>README</title></head><body><article class="markdown-body"><p><img src="https://user-images.githubusercontent.com/10807627/36499489-47bf1b6e-16f6-11e8-9a22-6e356c603a37.png" height="64"></p>
<h1 id="flotilla-os">flotilla-os<a class="headerlink" href="#flotilla-os" title="Permanent link"></a></h1>
<p><a href="https://circleci.com/gh/stitchfix/flotilla-os"><img alt="Circle CI" src="https://circleci.com/gh/stitchfix/flotilla-os.svg?style=shield" /></a>
<a href="https://goreportcard.com/report/github.com/stitchfix/flotilla-os"><img alt="Go Report Card" src="https://goreportcard.com/badge/github.com/stitchfix/flotilla-os" /></a></p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link"></a></h2>
<p>Flotilla is a self-service framework that dramatically simplifies the process of defining and executing containerized jobs. This means you get to focus on the work you&rsquo;re doing rather than <em>how</em> to do it.</p>
<p>Once deployed, Flotilla allows you to:</p>
<ul>
<li>Define containerized jobs by allowing you to specify exactly what command to run, what image to run that command in, and what resources that command needs to run</li>
<li>Run any previously defined job and access its logs, status, and exit code</li>
<li>View and edit job definitions with a flexible UI</li>
<li>Run jobs and view execution history and logs within the UI</li>
<li>Use the complete REST API for definitions, jobs, and logs to build your own custom workflows</li>
</ul>
<h2 id="philosophy">Philosophy<a class="headerlink" href="#philosophy" title="Permanent link"></a></h2>
<p>Flotilla is strongly opinionated about self-service for data science.</p>
<p>The core assumption is that you understand your work the best. Therefore, it is <em>you</em> who should own your work from end-to-end. In other words, you shouldn&rsquo;t need to be a &ldquo;production engineer&rdquo; to run your jobs or to access logs in case of problems. Do this with Flotilla.</p>
<h2 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link"></a></h2>
<h3 id="minimal-assumptions">Minimal Assumptions<a class="headerlink" href="#minimal-assumptions" title="Permanent link"></a></h3>
<p>Before we can do <em>anything</em> there&rsquo;s some <em>prerequistes</em> that must be met.</p>
<ol>
<li>Flotilla by default uses AWS. You must have an AWS account and AWS keys available. This quick-start guide uses AWS keys exported into the environment variables: <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code>. If you&rsquo;ve got credentials configured on your machine you can set these easily by running:</li>
</ol>
<div class="codehilite"><pre>export AWS_ACCESS_KEY_ID=$(aws --profile default configure get aws_access_key_id)
export AWS_SECRET_ACCESS_KEY=$(aws --profile default configure get aws_secret_access_key)
</pre></div>

<blockquote>
<p>Note: When running on AWS EC2 instances or ECS it&rsquo;s better practice to use an IAM profile for AWS credentials</p>
</blockquote>
<ol start="2">
<li>The AWS credentials must be authorized. The permissions required are described in the following policy document for AWS (you can attach it to a user or a role depending on how you manage users in AWS).</li>
</ol>
<div class="codehilite"><pre>{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Sid&quot;: &quot;flotilla-policy&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;sqs:DeleteMessage&quot;,
                &quot;sqs:ListQueues&quot;,
                &quot;sqs:GetQueueUrl&quot;,
                &quot;logs:DescribeLogGroups&quot;,
                &quot;sqs:ReceiveMessage&quot;,
                &quot;events:PutRule&quot;,
                &quot;sqs:SendMessage&quot;,
                &quot;sqs:GetQueueAttributes&quot;,
                &quot;ecs:DescribeClusters&quot;,
                &quot;ecs:DeregisterTaskDefinition&quot;,
                &quot;events:ListRuleNamesByTarget&quot;,
                &quot;ecs:RunTask&quot;,
                &quot;ecs:RegisterTaskDefinition&quot;,
                &quot;sqs:CreateQueue&quot;,
                &quot;ecs:ListContainerInstances&quot;,
                &quot;ecs:DescribeContainerInstances&quot;,
                &quot;ecs:ListClusters&quot;,
                &quot;ecs:StopTask&quot;,
                &quot;logs:CreateLogGroup&quot;,
                &quot;logs:PutRetentionPolicy&quot;,
                &quot;logs:GetLogEvents&quot;,
                &quot;events:PutTargets&quot;,
                &quot;sqs:SetQueueAttributes&quot;
            ],
            &quot;Resource&quot;: &quot;*&quot;
        }
    ]
}
</pre></div>

<ol start="3">
<li>Flotilla uses AWS&rsquo;s Elastic Container Service (ECS) and Elastic Kubernetes Service (EKS) as the execution backend. However, Flotilla does not manage ECS/EKS clusters. There must be at least one cluster defined in AWS&rsquo;s ECS/EKS service available to you and it must have at least one task node. Most typically this is the <code>default</code> cluster and examples will assume this going forward. You can easily set up a cluster by following the instructions here: <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/launch_container_instance.html">https://docs.aws.amazon.com/AmazonECS/latest/developerguide/launch_container_instance.html</a></li>
</ol>
<p><a href="https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html">https://docs.aws.amazon.com/eks/latest/userguide/what-is-eks.html</a></p>
<h3 id="starting-the-service-locally">Starting the service locally<a class="headerlink" href="#starting-the-service-locally" title="Permanent link"></a></h3>
<p>You can run the service locally (which will still leverage AWS resources) using the <a href="https://docs.docker.com/compose/">docker-compose</a> tool. From inside the repo run:</p>
<div class="codehilite"><pre>docker-compose up -d
</pre></div>

<p>You&rsquo;ll notice it builds the code in the repo and starts the flotilla service as well as the default postgres backend.</p>
<p>Verify the service is running by making a <code>GET</code> request with cURL (or navigating to in a web browser) the url <code>http://localhost:5000/api/v6/task</code>. A 200OK response means things are good!</p>
<blockquote>
<p>Note: The default configuration under <code>conf</code> and in the <code>docker-compose.yml</code> assume port 3000. You&rsquo;ll have to change it in both places if you don&rsquo;t want to use port 3000 locally.</p>
</blockquote>
<h3 id="using-the-ui">Using the UI<a class="headerlink" href="#using-the-ui" title="Permanent link"></a></h3>
<p>Flotilla has a simple, easy to use UI. Here&rsquo;s some example images for basic usage.</p>
<h4 id="define-a-task-with-the-ui">Define a task with the UI<a class="headerlink" href="#define-a-task-with-the-ui" title="Permanent link"></a></h4>
<p>The UI allows you to quickly create new tasks.</p>
<p><img alt="Define Task" src="https://user-images.githubusercontent.com/10807627/36499487-47a0b82c-16f6-11e8-886b-ca6d38276889.png" title="Create New Task" /></p>
<h4 id="launch-a-task-with-ui">Launch a task with UI<a class="headerlink" href="#launch-a-task-with-ui" title="Permanent link"></a></h4>
<p>You can run tasks you&rsquo;ve created with the UI as well. Once you&rsquo;ve ran a task the run will transition from <code>Queued</code> to <code>Pending</code> to <code>Running</code> before it finishes and shows <code>Success</code> or <code>Failed</code> (see <a href="#definitions-and-task-life-cycle">Task Life Cycle</a>). Once a task is in the <code>Running</code> state the logs should be visible.</p>
<ol>
<li>Launch</li>
</ol>
<p><img alt="Run Task" src="https://user-images.githubusercontent.com/10807627/36499492-481da436-16f6-11e8-9f14-5bbe8c297434.png" title="Run Task" /></p>
<ol start="2">
<li>Queued &ndash;&gt; Pending</li>
</ol>
<p><img alt="Queued Task" src="https://user-images.githubusercontent.com/10807627/36499491-4801515a-16f6-11e8-9525-db85bb999887.png" title="Queued Task" /></p>
<p><img alt="Pending Task" src="https://user-images.githubusercontent.com/10807627/36499490-47e27e88-16f6-11e8-8041-355de885be44.png" title="Pending Task" />
3. View logs</p>
<p><img alt="Running Task" src="https://user-images.githubusercontent.com/10807627/36499493-4842176c-16f6-11e8-9467-a345987bd407.png" title="Running Task" /></p>
<p><img alt="Finished Task" src="https://user-images.githubusercontent.com/10807627/36499494-48609cfa-16f6-11e8-8656-5504063cb6e7.png" title="Finished Task" /></p>
<h3 id="basic-api-usage">Basic API Usage<a class="headerlink" href="#basic-api-usage" title="Permanent link"></a></h3>
<h4 id="defining-your-first-task">Defining your first task<a class="headerlink" href="#defining-your-first-task" title="Permanent link"></a></h4>
<p>Before you can run a task you first need to define it. We&rsquo;ll use the example hello world task definition. Here&rsquo;s what that looks like:</p>
<blockquote>
<p>hello-world.json</p>
<div class="codehilite"><pre>{
  &quot;alias&quot;: &quot;hello-flotilla&quot;,
  &quot;group_name&quot;: &quot;examples&quot;,
  &quot;image&quot;: &quot;ubuntu:latest&quot;,
  &quot;memory&quot;: 512,
  &quot;env&quot;: [
    {
      &quot;name&quot;: &quot;USERNAME&quot;,
      &quot;value&quot;: &quot;_fill_me_in_&quot;
    }
  ],
  &quot;command&quot;: &quot;echo \&quot;hello ${USERNAME}\&quot;&quot;
}
</pre></div>

</blockquote>
<p>It&rsquo;s a simple task that runs in the default ubuntu image, prints your username to the logs, and exits.</p>
<blockquote>
<p>Note: While you can use non-public images and images in your own registries with flotilla, credentials for accessing those images must exist on the ECS hosts. This is outside the scope of this doc. See the AWS <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/private-auth.html">documentation</a>.</p>
</blockquote>
<p>Let&rsquo;s define it:</p>
<div class="codehilite"><pre>curl -XPOST localhost:5000/api/v6/task --data @examples/hello-world.json
</pre></div>

<p>You&rsquo;ll notice that if you visit the initial url again <code>http://localhost:5000/api/v6/task</code> the newly defined definition will be in the list.</p>
<h4 id="running-your-first-task">Running your first task<a class="headerlink" href="#running-your-first-task" title="Permanent link"></a></h4>
<p>This is the fun part. You&rsquo;ll make a <code>PUT</code> request to the execution endpoint for the task you just defined and specify any environment variables.</p>
<div class="codehilite"><pre>curl -XPUT localhost:5000/api/v6/task/alias/hello-flotilla/execute -d &#39;{
  &quot;cluster&quot;:&quot;default&quot;,
  &quot;env&quot;:[
    {&quot;name&quot;:&quot;USERNAME&quot;,&quot;value&quot;:&quot;yourusername&quot;}
  ],
  &quot;run_tags&quot;:{&quot;owner_id&quot;:&quot;youruser&quot;}
}&#39;
</pre></div>

<blockquote>
<p>Note: <code>run_tags</code> is defined as a way for all runs to have a ownership injected for visibility and is <em>required</em>.</p>
</blockquote>
<p>You&rsquo;ll get a response that contains a <code>run_id</code> field. You can check the status of your task at <code>http://localhost:5000/api/v6/history/&lt;run_id&gt;</code></p>
<div class="codehilite"><pre>curl -XGET localhost:5000/api/v6/history/&lt;run_id&gt;

{
  &quot;instance&quot;: {
    &quot;dns_name&quot;: &quot;&lt;dns-host-of-task-node&gt;&quot;,
    &quot;instance_id&quot;: &quot;&lt;instance-id-of-task-node&gt;&quot;
  },
  &quot;run_id&quot;: &quot;&lt;run_id&gt;&quot;,
  &quot;definition_id&quot;: &quot;&lt;definition_id&gt;&quot;,
  &quot;alias&quot;: &quot;hello-flotilla&quot;,
  &quot;image&quot;: &quot;ubuntu:latest&quot;,
  &quot;cluster&quot;: &quot;default&quot;,
  &quot;status&quot;: &quot;PENDING&quot;,
  &quot;env&quot;: [
    {
      &quot;name&quot;: &quot;FLOTILLA_RUN_OWNER_ID&quot;,
      &quot;value&quot;: &quot;youruser&quot;
    },
    {
      &quot;name&quot;: &quot;FLOTILLA_SERVER_MODE&quot;,
      &quot;value&quot;: &quot;dev&quot;
    },
    {
      &quot;name&quot;: &quot;FLOTILLA_RUN_ID&quot;,
      &quot;value&quot;: &quot;&lt;run_id&gt;&quot;
    },
    {
      &quot;name&quot;: &quot;USERNAME&quot;,
      &quot;value&quot;: &quot;yourusername&quot;
    }
  ]
}
</pre></div>

<p>and you can get the logs for your task at <code>http://localhost:5000/api/v6/&lt;run_id&gt;/logs</code>. You will not see any logs until your task is at least in the <code>RUNNING</code> state.</p>
<div class="codehilite"><pre>curl -XGET localhost:5000/api/v6/&lt;run_id&gt;/logs

{
  &quot;last_seen&quot;:&quot;&lt;last_seen_token_used_for_paging&gt;&quot;,
  &quot;log&quot;:&quot;+ set -e\n+ echo &#39;hello yourusername&#39;\nhello yourusername&quot;
}
</pre></div>

<h2 id="definitions-and-task-life-cycle">Definitions and Task Life Cycle<a class="headerlink" href="#definitions-and-task-life-cycle" title="Permanent link"></a></h2>
<h3 id="definitions">Definitions<a class="headerlink" href="#definitions" title="Permanent link"></a></h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>task</code></td>
<td>A definition of a task that can be executed to create a <code>run</code></td>
</tr>
<tr>
<td><code>run</code></td>
<td>An instance of a task</td>
</tr>
</tbody>
</table>
<h3 id="task-life-cycle">Task Life Cycle<a class="headerlink" href="#task-life-cycle" title="Permanent link"></a></h3>
<p>When executed, a task&rsquo;s run goes through several transitions</p>
<ol>
<li><code>QUEUED</code> - this is the first phase of a run and means the run is currently queued and waiting to be allocated to a cluster</li>
<li><code>PENDING</code> - every <code>worker.submit_interval</code> (defined in the config) the submit worker pulls from the queues and submits them for execution. At this point, if the cluster associated with the run has resources, the run gets allocated to the cluster and transitions to the <code>PENDING</code> status. For the default execution engine this stage encapsulates the process of pulling the docker image and starting the container. It can take several minutes depending on whether the image is cached and how large the image is.</li>
<li><code>RUNNING</code> - Once the run starts on a particular execution host it transitions to this stage. At this point logs should become available.</li>
<li><code>STOPPED</code> - A run enters this stage when it finishes execution. This can mean it either succeeded or failed depending on the existence of an <code>exit_code</code> and the value of that exit code.</li>
<li><code>NEEDS_RETRY</code> - on occassion, due to host level characteristics (full disk, too many open files, timeouts pulling image, etc) the run exits with a null exit code without ever being executed. In this case the reason is analyzed to determine if the run is retriable. If it is, the task transitions to this status and is allocated to the appropriate execution queue again, and will repeat the lifecycle.</li>
</ol>
<h4 id="normal-lifecycle">Normal Lifecycle<a class="headerlink" href="#normal-lifecycle" title="Permanent link"></a></h4>
<p><code>QUEUED</code> &ndash;&gt; <code>PENDING</code> &ndash;&gt; <code>RUNNING</code> &ndash;&gt; <code>STOPPED</code></p>
<h4 id="retry-lifecycle">Retry Lifecycle<a class="headerlink" href="#retry-lifecycle" title="Permanent link"></a></h4>
<p>&hellip; &ndash;&gt; <code>PENDING</code> &ndash;&gt; <code>STOPPED</code> &ndash;&gt; <code>NEEDS_RETRY</code> &ndash;&gt; <code>QUEUED</code> &ndash;&gt; &hellip;</p>
<h2 id="deploying">Deploying<a class="headerlink" href="#deploying" title="Permanent link"></a></h2>
<p>In a production deployment you&rsquo;ll want multiple instances of the flotilla service running and postgres running elsewhere (eg. Amazon RDS). In this case the most salient detail configuration detail is the <code>DATABASE_URL</code>.</p>
<h3 id="docker-based-deploy">Docker based deploy<a class="headerlink" href="#docker-based-deploy" title="Permanent link"></a></h3>
<p>The simplest way to deploy for very light usage is to avoid a reverse proxy and deploy directly with docker.</p>
<ol>
<li>
<p>Build and tag an image for flotilla using the <code>Dockerfile</code> provided in this repo:</p>
<p><div class="codehilite"><pre>docker build -t &lt;your repo name&gt;/flotilla:&lt;version tag&gt;
</pre></div>
2. Run this image wherever you deploy your services:</p>
<div class="codehilite"><pre>docker run -e DATABASE_URL=&lt;your db url&gt; -e FLOTILLA_MODE=prod -p 3000:3000 ...&lt;other standard docker run args&gt;
</pre></div>

<blockquote>
<h2 id="notes">Notes:<a class="headerlink" href="#notes" title="Permanent link"></a></h2>
<ul>
<li>Flotilla uses <a href="https://github.com/spf13/viper">viper</a> for configuration so you can override any of the default configuration under <code>conf/</code> using run time environment variables passed to <code>docker run</code></li>
<li>In most realistic deploys you&rsquo;ll likely want to configure a reverse proxy to sit in front of the flotilla container. See the docs <a href="https://hub.docker.com/_/nginx/">here</a></li>
</ul>
</blockquote>
<p>See <a href="https://docs.docker.com/engine/reference/run/">docker run</a> for more details</p>
</li>
</ol>
<h3 id="configuration-in-detail">Configuration In Detail<a class="headerlink" href="#configuration-in-detail" title="Permanent link"></a></h3>
<p>The variables in <code>conf/config.yml</code> are sensible defaults. Most should be left alone unless you&rsquo;re developing flotilla itself. However, there are a few you may want to change in a production environment.</p>
<table>
<thead>
<tr>
<th>Variable Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>worker.retry_interval</code></td>
<td>Run frequency of the retry worker</td>
</tr>
<tr>
<td><code>worker.submit_interval</code></td>
<td>Poll frequency of the submit worker</td>
</tr>
<tr>
<td><code>worker.status_interval</code></td>
<td>Poll frequency of the status update worker</td>
</tr>
<tr>
<td><code>http.server.read_timeout_seconds</code></td>
<td>Sets read timeout in seconds for the http server</td>
</tr>
<tr>
<td><code>http.server.write_timeout_seconds</code></td>
<td>Sets the write timeout in seconds for the http server</td>
</tr>
<tr>
<td><code>http.server.listen_address</code></td>
<td>The port for the http server to listen on</td>
</tr>
<tr>
<td><code>owner_id_var</code></td>
<td>Which environment variable containing ownership information to inject into the runtime of jobs</td>
</tr>
<tr>
<td><code>enabled_workers</code></td>
<td>This variable is a list of the workers that run. Use this to control what workers run when using a multi-container deployment strategy. Valid list items include (<code>retry</code>, <code>submit</code>, and <code>status</code>)</td>
</tr>
<tr>
<td><code>log.namespace</code></td>
<td>For the default ECS execution engine setup this is the <code>log-group</code> to use</td>
</tr>
<tr>
<td><code>log.retention_days</code></td>
<td>For the default ECS execution engine this is the number of days to retain logs</td>
</tr>
<tr>
<td><code>log.driver.options.*</code></td>
<td>For the default ECS execution engine these map to the <code>awslogs</code> driver options <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/using_awslogs.html">here</a></td>
</tr>
<tr>
<td><code>queue.namespace</code></td>
<td>For the default ECS execution engine this is the prefix used for SQS to determine which queues to pull job launch messages from</td>
</tr>
<tr>
<td><code>queue.retention_seconds</code></td>
<td>For the default ECS execution engine this configures how long a message will stay in an SQS queue without being consumed</td>
</tr>
<tr>
<td><code>queue.process_time</code></td>
<td>For the default ECS execution engine configures the length of time allowed to process a job launch message</td>
</tr>
<tr>
<td><code>queue.status</code></td>
<td>For the default ECS execution engine this configures which SQS queue to route ECS cluster status updates to</td>
</tr>
<tr>
<td><code>queue.status_rule</code></td>
<td>For the default ECS execution engine this configures the name of the rule for routing ECS cluster status updates</td>
</tr>
<tr>
<td><code>metrics.dogstatsd.address</code></td>
<td>Statds metrics host in Datadog format</td>
</tr>
<tr>
<td><code>metrics.dogstatsd.namespace</code></td>
<td>Namespace for the metrics - for example <code>flotilla.</code></td>
</tr>
<tr>
<td><code>redis_address</code></td>
<td>Redis host for caching and locks</td>
</tr>
<tr>
<td><code>redis_db</code></td>
<td>Redis db to be used - numeric</td>
</tr>
</tbody>
</table>
<h2 id="development">Development<a class="headerlink" href="#development" title="Permanent link"></a></h2>
<h3 id="api-documentation">API Documentation<a class="headerlink" href="#api-documentation" title="Permanent link"></a></h3>
<p>See <a href="https://stitchfix.github.io/flotilla-os/api.html">API</a></p>
<h3 id="building">Building<a class="headerlink" href="#building" title="Permanent link"></a></h3>
<p>Currently Flotilla is built using <code>go</code> 1.9.3 and uses the <a href="https://github.com/kardianos/govendor"><code>govendor</code></a> to manage dependencies.</p>
<div class="codehilite"><pre>govendor sync &amp;&amp; go build
</pre></div></article></body></html>